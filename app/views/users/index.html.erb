<%= render 'navtab' %>
<p id="notice"><%= notice %></p>
<h1>Utilisateurs</h1>
<div class="card">
  <div class="card-body">
    <%= form_with url: users_path, method: :get do |form| %>
      <%= form.text_field :user_id, placeholder:"Chercher par numÃ©ro" %>
      <%= form.text_field :user_name, placeholder:"Chercher par nom" %>
      <%= form.text_field :user_mail, placeholder:"Chercher par mail" %>
      <%= form.submit "Filtrer", class:"btn btn-primary" %>
    <% end %>
  </div>
</div>
<table class="table table-bordered table-striped">
  <thead class="table-dark">
    <tr>
      <th>Id</th>
      <th>Email</th>
      <th>Nom</th>
      <th>PrÃ©nom</th>
      <th>TÃ©lÃ©phone</th>
      <th>Ville</th>
      <th>Code postal</th>
      <th>Adresse</th>
      <th>Administrateur</th>
      <th>IP</th>
      <th colspan="5"></th>
    </tr>
  </thead>
  <tbody>
    <% @users.each do |user| %>
      <tr>
        <td><%= user.id %></td>
        <td><%= user.email %></td>
        <td><%= user.first_name %></td>
        <td><%= user.last_name %></td>
        <td><%= user.phone %></td>
        <td><%= user.city %></td>
        <td><%= user.postal_code %></td>
        <td><%= user.address %></td>
        <td>
          <% if user.is_admin %>
            Oui
          <% else %>
            Non
          <% end %>
        </td>
        <td><%= user.ip %>
        <% if Blacklist.find_by_ip(request.remote_ip).present? %>
        (ðŸš«)
        <% end %>
        </td>
        <td><%= link_to 'ðŸ›’', orders_path(:order => {:user_id => user.id}), method: :post, data: { confirm: 'Voulez vous crÃ©Ã©e une commande ?' } %></td>
        <td><%= link_to 'ðŸ”Ž', user %></td>
        <td><%= link_to 'âœï¸', edit_user_path(user) %></td>
        <td><%= link_to 'ðŸ—‘ï¸', user, method: :delete, data: { confirm: 'ÃŠtes-vous certain ? Suppression du client ðŸš«' } %></td>
        <td><%= link_to 'ðŸš«BAN', blacklists_path(:blacklist => {:ip => user.ip}), method: :post, data: { confirm: 'ðŸš«ðŸš«ðŸš«ATTENTIONðŸš«ðŸš«ðŸš« LE USER VA DEFINITIVEMENT ETRE BANNI ET NE POURRA PLUS ACCEDER AU SITE!!! ETES VOUS CERTAINS ??? ðŸš«ðŸš«ðŸš« (Vous pouvez manuellement retirer les IP bannies dans la liste noire' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>
<%= paginate @users %>

<br>
<%= link_to 'CrÃ©e utilisateur', new_user_path, class:"btn btn-dark"  %>
<%= link_to 'AccÃ©der Ã  la liste noire', blacklists_path, class:"btn btn-dark"  %>
